const paintingsInOrder = {
  "IMG_20240422_175529_875.png": {
    description: "Figure",
    price: 25000
  },
  "IMG_20240408_165850_607.png": {
    description: "Figure (print)",
    price: 10000
  },
  "IMG_20240408_165850_641.png": {
    description: "Figure (print)",
    price: 10000
  },
  "IMG_20240408_164102_836.png": {
    description: "Figure",
    price: 10000
  },
  "IMG_20240325_072057_320-EDIT.jpg": {
    description: "A subway scene",
    price: 10000
  },
  "BadAtChess.jpg": {
    description: "Bad at chess",
    price: 10000
  },
  "file-kKPq8MyTW33xp5wGje2qzIEl.jpg": {
    description: "An interesting figure",
    price: 10000
  },
  // "20230930_232601.jpg": {
  //   description: "Charon on the river styx",
  //   price: 0
  // },
  "IMG_20231008_154039_624.jpg": {
    description: "Archangel waiting in cave (print)",
    price: 10000
  },
  "20231114_204153.jpg": {
    description: "He lives amongst the people (print)",
    price: 5000
  },
  "file-SP3jmI3tojDSOwGdcLoyboJN.jpg": {
    description: "Nature is beautiful (print)",
    price: 5000
  },
  "20231203_230336-EDIT(1).jpg": {
    description: "Saint marzano (print)",
    price: 1500
  },
  "071477A9-92EA-4B0D-94C6-13516E581B19.jpg": {
    description: "Figure",
    price: 10000
  },
  "IMG_0094.png": {
    description: "Figure",
    price: 0
  },
  "IMG_20240226_223909_466.png": {
    description: "Figure",
    price: 20000
  },
  "IMG_0096.png": {
    description: "Figure (print)",
    price: 5000
  },
  "CamScanner 07-25-2021 14.51_2.jpg": {
    description: "All the opps die every summer",
    price: 50000
  },
  // "IMG_20230913_235900_919.jpg": {
  //   description: "Figure",
  //   price: 10000
  // },
  // "IMG_20230913_235900_937.jpg": {
  //   description: "Figure",
  //   price: 10000
  // },
  // "20231006_080704.jpg": {
  //   description: "Figure",
  //   price: 10000
  // },
  // "IMG_20210625_110136_745.jpg": {
  //   description: "figure",
  //   price: 10000
  // },
  // "IMG_20210616_104906_048.jpg": {
  //   description: "figure",
  //   price: 10000
  // },
  // "IMG_20210609_105420_205.jpg": {
  //   description: "figure",
  //   price: 10000
  // },
  // "CamScanner 06-01-2021 22.35_2.jpg": {
  //   description: "figure",
  //   price: 10000
  // },
  "PSX_20220116_201947.jpg": {
    description: "Nightmare",
    price: 25000
  },
  "20231006_075327.jpg": {
    description: "brooklyn bridge park",
    price: 10000
  },
  "CamScanner 05-06-2024 23.18_4 (1).jpg": {
    description: "figure drawing",
    price: 10000
  },
  "IMG_20230603_124706_633.jpg": {
    description: "figure drawing",
    price: 10000
  },
  "PSX_20221105_143540.jpg": {
    description: "ferns with bust of mao zedong",
    price: 50000
  },
  // "IMG_20180403_211743_814.jpg": {
  //   description: "bananas",
  //   price: 10000
  // },
  // "IMG_20181013_152232_310.jpg": {
  //   description: "laying in a dream",
  //   price: 10000
  // },
  // "IMG_20181101_121648_941.jpg": {
  //   description: "me sitting on a couch with easel",
  //   price: 10000
  // },
  "IMG_20190703_001616_015.jpg": {
    description: "navigating the world of dreams",
    price: 15000
  },
  "IMG_20190716_074334_279.jpg": {
    description: "Face (acrylic on paper)",
    price: 10000
  },
  "IMG_20191111_034703_152.jpg": {
    description: "cow minding its business",
    price: 10000
  },
  // "IMG_20200328_110527_975.jpg": {
  //   description: "anotha one",
  //   price: 10000
  // },
  "IMG_20200409_163824_231.jpg": {
    description: "early worm gets the bird",
    price: 10000
  },
  "IMG_20200424_083904_030.jpg": {
    description: "we each see nature through different eyes",
    price: 10000
  },
  "IMG_20200906_164258_023.jpg": {
    description: "don't cry blue sky",
    price: 10000
  },
  "IMG_20201026_122134_504.jpg": {
    description: "a strange invention",
    price: 10000
  },
  "IMG_20201122_162742_417.jpg": {
    description: "monkey minding its business",
    price: 10000
  },
  "CamScanner 11-22-2020 22.38_1.jpg": {
    description: "study of a gofundme campaign",
    price: 10000
  },
  // "IMG_20201201_143123_797.jpg": {
  //   description: "I like this one",
  //   price: 10000
  // },
  // "IMG_20201214_115726_587.jpg": {
  //   description: "man tortured by Santa's elves",
  //   price: 10000
  // },
  "IMG_20201231_144606_532.jpg": {
    description: "burnt umber (print)",
    price: 3000
  },
  "IMG_20210105_192944_337.jpg": {
    description: "view from my window (print)",
    price: 3000
  },
  "IMG_20210114_114200_455.jpg": {
    description: "man on the verge of caring (print)",
    price: 2000
  },
  "IMG_20210417_175028_411.jpg": {
    description: "extinction button",
    price: 5000
  },
  "IMG_20210424_130913_187.jpg": {
    description: "$MD by A$AP Bocky",
    price: 0
  },
  "IMG_20210426_111243_392.jpg": {
    description: "a door",
    price: 20000
  },
  "IMG_20210429_105801_166.jpg": {
    description: "AT.BONG.BLAST.Aâ‚¿AP",
    price: 10000
  },
  "modded3.bmp": {
    description: "digitally edited",
    price: 0
  }
};

var paintings = document.getElementById("paintings");

for (let element in paintingsInOrder) {
  const path = "../paintings/-/" + element;
  const thumbnail_path = "../paintings/-compressed/thumb_" + element;

  // Create the painting container
  var paintingContainer = document.createElement("div");
  paintingContainer.classList.add("painting-container");

  // Create the image link
  var imgLink = document.createElement("a");
  imgLink.href = path;
  imgLink.classList.add("painting-image-link");

  // Create the image element
  var img = document.createElement("img");
  img.classList.add("art");
  img.src = thumbnail_path;
  img.alt = paintingsInOrder[element]["description"];

  // Append the image to the link
  imgLink.appendChild(img);

  // Create the description box (now also acts as a button)
  var descriptionBox = document.createElement("a");
  descriptionBox.classList.add("painting-description");
  descriptionBox.href = "#"; // We'll override this with JavaScript
  
  // Create a span for the description text
  var descriptionText = document.createElement("span");
  descriptionText.classList.add("description-text");
  descriptionText.innerText = paintingsInOrder[element]["description"];
  
  // Create a span for the price
  var priceText = document.createElement("span");
  priceText.classList.add("price-text");
  priceText.innerText = paintingsInOrder[element].price > 0 ? `$${(paintingsInOrder[element].price / 100).toFixed(2)}` : "NFS";  

  // Append description and price to the description box
  descriptionBox.appendChild(descriptionText);
  descriptionBox.appendChild(priceText);

  // Add click event listener to the description box
  if (paintingsInOrder[element].price > 0){
    descriptionBox.addEventListener("click", (e) => {
      e.preventDefault(); // Prevent default link behavior
      initiateCheckout(element, paintingsInOrder[element].price, thumbnail_path);
    });
  }

  // Append the image link and description box to the container
  paintingContainer.appendChild(imgLink);
  paintingContainer.appendChild(descriptionBox);

  // Append the container to the paintings grid
  paintings.appendChild(paintingContainer);
}

async function initiateCheckout(paintingId, price, imagePath) {
  try {
    // Get the full URL of the image
    const fullImageUrl = new URL(imagePath, window.location.origin).href;

    const response = await fetch('https://q6lp56ph6dhosmyn7xh32jyipy0epgjw.lambda-url.us-east-1.on.aws/', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        line_items: [
          {
            price_data: {
              currency: "usd",
              product_data: {
                name: paintingsInOrder[paintingId]["description"],
                images: [fullImageUrl]
              },
              unit_amount: price
            },
            quantity: 1
          }
        ]
      }),
    });

    const { url } = await response.json();
    
    // Redirect to Stripe Checkout
    window.location.href = url;
  } catch (error) {
    console.error('Error creating checkout session:', error);
    alert('There was an error processing your request. Please try again.');
  }
}
